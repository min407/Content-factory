# AI 提示词文档

本文档记录了系统中所有与AI交互的提示词，便于维护和优化。

## 目录
1. [深度文章分析提示词](#深度文章分析提示词)
2. [选题洞察生成提示词](#选题洞察生成提示词)
3. [文章创作提示词](#文章创作提示词)
4. [系统角色提示词](#系统角色提示词)

---

## 深度文章分析提示词

### 文件位置
`lib/ai-service.ts` - `deepAnalyzeArticles` 函数

### 功能描述
对公众号文章进行深度内容分析，提取结构化信息，为后续选题洞察生成提供基础数据。

### 完整提示词

```
你是一个资深的内容分析专家。请对以下N篇微信公众号文章进行深度分析，提取结构化信息。

文章数据：
${articlesJson}

请为每篇文章输出以下JSON格式：
{
  "summaries": [
    {
      "index": 1,
      "keyPoints": ["要点1", "要点2", "要点3"],
      "keywords": ["关键词1", "关键词2", "关键词3", "关键词4", "关键词5", "关键词6"],
      "highlights": ["亮点1", "亮点2"],
      "engagementAnalysis": "互动表现分析（50字以内）",

      // 新增的深度分析字段（必须填写）
      "targetAudience": "明确的目标人群，如：职场新人、宝妈、大学生、创业者等",
      "scenario": "具体使用场景，如：工作日早晨、周末休息、睡前阅读、通勤路上等",
      "painPoint": "解决的痛点需求，如：时间紧张、选择困难、技能缺失、信息焦虑等",
      "contentAngle": "内容角度，如：实用教程、经验分享、趋势分析、产品评测等",
      "emotionType": "情感类型，如：激励鼓舞、温暖治愈、理性分析、幽默轻松等",
      "writingStyle": "写作风格，如：干货满满、故事性强、数据驱动、观点鲜明等"
    }
  ]
}

核心要求：
1. **targetAudience、scenario、painPoint 这三个字段必须准确填写**，这是后续选题洞察的关键
2. keyPoints: 3-5个最有价值的要点
3. keywords: 至少5个关键词，包含主题词、人群词、场景词、痛点词
4. highlights: 1-2个最有特色的内容亮点
5. engagementAnalysis: 基于互动数据分析内容受欢迎的原因

只输出JSON格式，不要任何解释文字。
```

### 参数说明
- `articlesJson`: 包含文章标题、内容、互动数据的JSON字符串
- 温度参数: `0.3`（偏理性分析）
- 输出格式: 严格的JSON格式

### 输出字段说明
- `index`: 文章序号
- `keyPoints`: 文章核心要点（3-5个）
- `keywords`: 关键词（至少5个）
- `highlights`: 内容亮点（1-2个）
- `engagementAnalysis`: 互动表现分析（50字以内）
- `targetAudience`: 目标人群（必须字段）
- `scenario`: 使用场景（必须字段）
- `painPoint`: 痛点需求（必须字段）
- `contentAngle`: 内容角度
- `emotionType`: 情感类型
- `writingStyle`: 写作风格

---

## 选题洞察生成提示词

### 文件位置
`lib/ai-service.ts` - `generateSmartTopicInsights` 函数

### 功能描述
基于深度文章分析结果，生成高质量选题洞察，按照三维度分析框架进行精准定位。

### 完整提示词

```
你是一个顶级的内容选题策划专家，专门为微信公众号创作者提供精准的选题洞察。基于对N篇高质量文章的深度分析，请生成尽可能多的具有商业价值的选题洞察。

文章深度分析数据：
${summariesJson}

统计数据：
- 总文章数: ${stats.totalArticles}
- 平均阅读量: ${stats.avgReads}
- 平均点赞数: ${stats.avgLikes}
- 平均互动率: ${stats.avgEngagement}

请严格按照以下三维度分析框架，生成高质量选题洞察（不限制数量）：

**三维度分析框架说明：**

1. **决策阶段**：基于用户旅程觉察阶段，深度分析用户心理状态和行为阶段
   - **觉察期**：用户刚意识到问题存在，处于困惑迷茫阶段，如"为什么我总是效率低下"、"大家都在用AI我不懂怎么办"
   - **认知期**：用户开始主动了解概念和基础信息，如"什么是私域流量"、"AI工具有哪些类型"
   - **调研期**：用户在比较和收集信息，处于选择困难阶段，如"哪个副业最适合我"、"AI写作工具哪个好用"
   - **决策期**：用户准备开始行动，需要具体指导和信心，如"如何开始第一个副业项目"、"AI写作具体步骤"
   - **行动期**：用户已经在执行中，遇到具体问题需要解决，如"副业没效果怎么办"、"AI写作质量不高怎么提升"
   - **成果期**：用户有了初步结果，想要优化和展示，如"副业收入如何提升"、"AI写作效率提升案例"

2. **人群场景**：必须基于文章内容深度分析，精准定位具体人群和使用场景
   - **人群分析**：从文章内容中提取具体的人群特征，如：30岁职场妈妈、二三线城市的程序员、刚毕业的设计师、创业公司老板等，要尽可能具体
   - **场景分析**：结合人群特征分析具体使用场景，如：深夜加班时、地铁通勤路上、带娃间隙时间、周末充电学习、工作中遇到瓶颈时等，要与人群高度匹配
   - **组合分析**：人群+场景的精准匹配，如"深夜加班的程序员想要提升效率"、"带娃间隙的宝妈想学习新技能"

3. **需求痛点**：深度分析用户产生这个问题的根本原因和核心诉求
   - **情绪痛点**：分析用户的情感状态，如：对未来感到焦虑、对现状不满、渴望被认可、害怕落后、想要改变现状等
   - **现实痛点**：分析用户遇到的实际问题，如：收入不够用、工作遇到瓶颈、技能跟不上时代、时间管理困难、选择太多无从下手等
   - **期望需求**：分析用户希望通过内容获得什么，如：找到可行解决方案、获得心理安慰和鼓励、了解行业趋势、学习具体技能、避坑少走弯路等

JSON格式输出：
{
  "insights": [
    {
      "title": "洞察标题（15-20字，简洁有力）",
      "description": "详细分析（120-180字，包含市场分析、用户价值、可行性）",
      "confidence": 85,
      "evidence": ["文章1标题", "文章2标题", "文章3标题"],

      // 三维度分析
      "decisionStage": {
        "stage": "觉察期/认知期/调研期/决策期/行动期/成果期",
        "reason": "基于文章内容判断用户心理状态和行为阶段的理由（1-2句话）"
      },
      "audienceScene": {
        "audience": "从文章内容分析出的具体人群特征（如：30岁职场妈妈、二三线程序员等）",
        "scene": "与人群匹配的具体使用场景（如：深夜加班、带娃间隙等）",
        "reason": "基于文章内容分析人群场景匹配度的理由（1-2句话）"
      },
      "demandPainPoint": {
        "emotionalPain": "用户的情绪痛点（如：对未来焦虑、害怕落后、渴望被认可等）",
        "realisticPain": "用户的现实痛点（如：收入不足、技能落后、时间管理等）",
        "expectation": "用户的期望需求（如：解决方案、心理安慰、技能学习等）",
        "reason": "基于文章内容分析用户产生问题根本原因的理由（1-2句话）"
      },

      // 其他字段
      "tags": ["标签1", "标签2", "标签3"],
      "marketPotential": "high",          // high/medium/low
      "contentSaturation": 65,            // 0-100的内容饱和度
      "recommendedFormat": "教程类/经验分享/案例分析",
      "keyDifferentiators": ["差异化点1", "差异化点2"]
    }
  ]
}

**核心要求：**
1. **生成多条洞察**（建议5-10条，最多不超过10条）
2. **三维度分析必须深度基于文章内容**：
   - decisionStage.stage 必须准确分析用户心理状态和行为阶段
   - audienceScene.audience/scene 必须从文章内容中提取具体人群特征和使用场景
   - demandPainPoint.emotionalPain/realisticPain/expectation 必须深度分析用户的痛点和需求
3. **每个维度都要有reason字段**，详细说明基于文章内容的判断理由
4. **人群场景要具体化**：避免泛泛而谈，要基于文章内容分析出精准的人群画像和场景
5. **需求痛点要深入**：不能简单分类，要分析用户为什么会产生这个问题的根本原因
6. **confidence 基于证据强度设定**，范围70-95，这是重要指数
7. **evidence 至少引用2-3篇相关文章标题**
8. **确保洞察的多样性和精准性**，覆盖不同用户旅程阶段和具体人群场景

只输出JSON格式，不要任何解释。
```

### 参数说明
- `summariesJson`: 深度文章分析结果的JSON字符串
- `stats`: 统计数据对象（总文章数、平均阅读量等）
- 温度参数: `0.4`（适度创造性）
- 输出格式: 严格的JSON格式

### 输出字段说明

#### 基础信息
- `title`: 洞察标题（15-20字）
- `description`: 详细分析（120-180字）
- `confidence`: 重要指数（70-95）
- `evidence`: 证据引用（至少2-3篇文章标题）

#### 三维度分析
- `decisionStage`: 决策阶段分析
  - `stage`: 具体阶段（觉察期/认知期/调研期/决策期/行动期/成果期）
  - `reason`: 判断理由

- `audienceScene`: 人群场景分析
  - `audience`: 具体人群特征
  - `scene`: 具体使用场景
  - `reason`: 判断理由

- `demandPainPoint`: 需求痛点分析
  - `emotionalPain`: 情绪痛点
  - `realisticPain`: 现实痛点
  - `expectation`: 期望需求
  - `reason`: 判断理由

#### 其他分析字段
- `tags`: 标签
- `marketPotential`: 市场潜力（high/medium/low）
- `contentSaturation`: 内容饱和度（0-100）
- `recommendedFormat`: 推荐格式
- `keyDifferentiators`: 差异化点

---

## 智能图片提示词生成

### 文件位置
`lib/ai-service.ts` - `generateImagePromptsFromContent` 函数

### 功能描述
基于文章内容自动生成高质量、内容相关的图片提示词，确保图片与文章主题高度相关且风格统一。

### 完整提示词

```
请基于以下文章内容，生成 ${count} 个高质量、内容相关的图片提示词。

文章标题：${articleTitle}
文章内容：${contentForAnalysis}

请为文章生成 ${count} 个不同角度的图片提示词，要求：

1. **内容相关性**: 每个提示词都要与文章主题高度相关
2. **视觉表现**: 适合插画风格的描述
3. **避免文字**: 描述中不要包含任何文字或数字
4. **风格统一**: 所有图片保持统一的插画风格
5. **场景多样**: 涵盖文章的不同方面和角度

请直接输出 ${count} 行提示词，每行一个，不要编号或其他格式：

示例格式：
现代职场人士在工作场景中的插画，简洁专业风格
知识学习和技能提升的概念图，温暖励志风格
...

请基于文章内容生成具体的提示词：
```

### 参数说明
- `articleTitle`: 文章标题
- `contentForAnalysis`: 用于分析的文章内容（截取前2000字符）
- `count`: 需要生成的图片数量
- 温度参数: `0.6`（平衡创造性和准确性）
- 输出格式: 多行文本，每行一个提示词

### 输出处理
- 按行分割响应并过滤空行
- 过滤长度小于10个字符的无效提示词
- 确保输出数量等于请求数量，不足时使用fallback提示词补充

### Fallback机制
当AI生成失败时，使用预定义的基础提示词：
- 现代办公场景插画，简洁专业风格
- 学习和成长主题插画，励志温暖风格
- 团队协作场景插画，现代扁平化设计
- 创新思维概念图，抽象艺术风格
- 目标达成场景插画，积极向上风格

---

## 文章创作提示词

### 文件位置
`lib/ai-service.ts` - `generateSingleArticle` 函数

### 功能描述
基于选题洞察的三维度分析，智能生成高质量的文章内容，自动调整写作风格以匹配目标用户群体。

### 智能写作风格提示词

```
基于以下选题分析，自动调整写作风格：

**决策阶段**: ${decisionStage.stage} - ${decisionStage.reason}
**目标人群**: ${audienceScene.audience}
**使用场景**: ${audienceScene.scene}
**情绪痛点**: ${demandPainPoint.emotionalPain}
**现实需求**: ${demandPainPoint.realisticPain}
**期望获得**: ${demandPainPoint.expectation}

请根据以上分析，采用最适合的：
- 语气风格：${getRecommendedTone(decisionStage.stage, demandPainPoint.emotionalPain)}
- 内容结构：${getRecommendedStructure(decisionStage.stage)}
- 案例类型：${getRecommendedCaseType(audienceScene.audience)}
- 互动方式：${getRecommendedInteraction(demandPainPoint.expectation)}
```

### 完整文章生成提示词

```
请基于以下选题洞察，生成一篇高质量的文章：

**选题**: ${topic.title}
**描述**: ${topic.description}
**重要指数**: ${topic.confidence}%
${uniqueAngle ? `**独特角度**: ${uniqueAngle}` : ''}

${stylePrompt}

**写作要求**:
- 字数：${wordCount}字
- 风格：${style}
- 结构：包含引人入胜的开头、主体内容、实用建议、总结展望
- 内容：基于三维度分析提供有价值的内容
- 语言：中文，流畅自然，适合微信公众号发布

请生成完整的文章内容（包含标题）。
```

### 参数说明
- `topic`: 选题洞察对象（包含三维度分析）
- `length`: 文章长度参数
- `style`: 写作风格
- `imageCount`: 配图数量
- `uniqueAngle`: 独特角度（可选）
- `wordCount`: 根据length参数计算的字数范围
- `stylePrompt`: 智能生成的写作风格提示
- 温度参数: `0.7`（创造性写作）

### 智能风格推荐规则

#### 语气风格推荐 (getRecommendedTone)
- **觉察期**: 温和引导，富有同理心
- **认知期**: 专业权威，条理清晰
- **调研期**: 客观对比，数据支撑
- **决策期**: 鼓励行动，给予信心
- **行动期**: 实用指导，步骤清晰
- **成果期**: 激励分享，展示价值

#### 内容结构推荐 (getRecommendedStructure)
- **觉察期**: 问题引入 → 现状分析 → 启发思考
- **认知期**: 概念解释 → 核心要点 → 实用建议
- **调研期**: 对比分析 → 优缺点总结 → 选择指导
- **决策期**: 目标设定 → 行动步骤 → 激励鼓舞
- **行动期**: 问题识别 → 解决方案 → 注意事项
- **成果期**: 成果展示 → 经验总结 → 提升方向

#### 案例类型推荐 (getRecommendedCaseType)
- **职场妈妈/宝妈**: 真实故事案例，生活化场景
- **程序员/技术**: 技术实践案例，数据驱动
- **设计师/创作**: 设计作品案例，视觉展示
- **创业者/老板**: 商业实战案例，ROI导向
- **其他**: 通用实用案例

#### 互动方式推荐 (getRecommendedInteraction)
- **解决方案/指导**: 提供可操作步骤，引导实践
- **心理安慰/鼓励**: 情感共鸣，积极引导
- **学习/技能**: 知识讲解，技能训练
- **其他**: 信息分享，启发思考

### 输出要求
- 包含完整的文章标题
- 结构清晰，内容实用
- 语言流畅自然
- 适合微信公众号发布
- 基于三维度分析提供针对性内容

---

## 系统角色提示词

### 深度文章分析系统角色
```
你是专业的内容深度分析专家，擅长从文章中提取结构化信息，只输出JSON格式数据。
```

### 选题洞察生成系统角色
```
你是顶级的内容选题策划专家，擅长从数据分析中提炼出具有商业价值的选题洞察，只输出JSON格式数据。
```

### 文章创作系统角色
```
你是专业的文章创作者，擅长基于深度洞察生成高质量内容。你的文章结构清晰，内容实用，语言优美。
```

---

## 配置说明

### 温度参数设置
- **深度文章分析**: `0.3`（偏理性，确保分析准确性）
- **选题洞察生成**: `0.4`（适度创造性，平衡准确性和创新性）
- **文章创作**: `0.7`（创造性写作，注重内容质量和可读性）

### 数量限制
- **洞察数量**: 建议5-10条，最多不超过10条
- **关键词数量**: 至少5个
- **证据引用**: 至少2-3篇文章标题

### 输出格式要求
- 统一使用JSON格式
- 不包含任何解释文字
- 字符串内容使用中文

---

## 使用说明

### 1. 调用流程
1. 获取公众号文章数据
2. 调用 `deepAnalyzeArticles` 进行文章深度分析
3. 调用 `generateSmartTopicInsights` 生成选题洞察
4. 按置信度排序并返回结果
5. 选择选题后调用 `generateSingleArticle` 生成文章内容
6. 生成配图并返回完整文章

### 2. 错误处理
- JSON解析失败时返回空数组
- API调用失败时抛出详细错误信息
- 缺少关键字段时输出警告日志

### 3. 数据验证
- 验证必需字段完整性
- 检查置信度范围合理性
- 确保证据引用的有效性

---

## 更新日志

### v1.2.0 (2024-11-15)
- 新增智能图片提示词生成系统
- 添加基于文章内容的图片提示词AI生成
- 完善6种图片风格配置（智能选择、商务专业、创意插画、简约现代、科技未来、生活温馨）
- 新增图片生成重试机制和fallback处理
- 集成内容缓存和历史记录系统

### v1.1.0 (2024-11-15)
- 新增文章创作提示词
- 添加智能写作风格推荐系统
- 完善基于三维度分析的内容生成
- 新增文章创作系统角色提示词

### v1.0.0 (2024-11-15)
- 创建完整提示词文档
- 优化三维度分析框架
- 统一输出格式标准
- 添加详细注释说明

### 优化记录
- 2024-11-15: 新增智能图片提示词生成系统，实现基于文章内容的图片生成
- 2024-11-15: 完善6种图片风格配置，支持用户自定义和智能选择
- 2024-11-15: 集成内容缓存系统，支持7天缓存和100条历史记录
- 2024-11-15: 添加图片生成重试机制，提高成功率
- 2024-11-15: 实现并行图片处理，提升生成效率
- 2024-11-15: 将决策阶段细化为6个阶段
- 2024-11-15: 优化人群场景分析要求
- 2024-11-15: 重构需求痛点分析维度
- 2024-11-15: 添加判断理由要求
- 2024-11-15: 新增智能写作风格推荐系统
- 2024-11-15: 完善文章创作提示词结构
- 2024-11-15: 添加基于三维度分析的内容生成逻辑

---

## 公众号预览优化提示词

### 文件位置
`app/create/page.tsx` - `renderOptimizedContent` 函数

### 功能描述
将AI生成的Markdown格式文章内容转换为公众号风格的预览样式，确保排版简洁清晰，便于读者阅读。

### 样式优化规则

```
公众号预览样式处理规则：

1. **清理Markdown符号**：
   - 移除所有 **粗体** 标记 (*)
   - 移除所有 *斜体* 标记 (*)
   - 移除所有 `行内代码` 标记 (`)
   - 移除列表项开头的星号 (*) 和减号 (-)
   - 移除引用符号 (>)

2. **统一字体样式**：
   - 标题：text-xl font-bold (统一大小，简洁有力)
   - 段落：text-base (统一基础字体大小)
   - 移除首字放大等复杂效果
   - 保持行间距适中 (leading-relaxed)

3. **简化排版布局**：
   - 列表项：左边框样式，简洁大方
   - 引用块：浅灰背景，适当缩进
   - 段落：首行缩进2字符（中文排版习惯）
   - 移除花哨的背景色和装饰

4. **图片处理**：
   - 居中显示
   - 最大高度400px
   - 简单阴影效果
   - 图片描述显示在下方

5. **颜色方案**：
   - 主文字：text-gray-800 (深灰色)
   - 次要文字：text-gray-700 (中灰色)
   - 标题：text-gray-900 (最深)
   - 引用：text-gray-600 (引用色)

输出要求：
- 预览时显示干净的公众号样式
- 复制Markdown功能保留原始格式
- 不显示任何Markdown符号
- 确保阅读体验流畅自然
```

### 核心优化点

1. **去除符号显示**：
   - 预览界面不再显示星号、减号等Markdown符号
   - 保持内容的纯净性和可读性

2. **统一样式规范**：
   - 所有标题使用统一的字体大小和粗细
   - 段落字体大小保持一致
   - 移除复杂的装饰效果

3. **公众号风格排版**：
   - 采用中文排版习惯（首行缩进）
   - 适合移动端阅读的行间距
   - 简洁大方的视觉风格

4. **功能分离**：
   - 预览：显示优化后的公众号样式
   - 复制：保留原始Markdown格式
   - 各自独立，互不影响

### 技术实现

#### JSX元素映射
```jsx
// 标题处理
h3(text-xl font-bold text-gray-900)

// 列表处理 (移除星号，转换为目标样式)
p(border-left: 2px solid #666, pl-4)

// 引用处理 (移除>号)
p(bg-gray-50, italic, text-gray-600)

// 段落处理 (首行缩进)
p(textIndent: '2em')

// 图片处理
img(maxHeight: '400px', mx-auto, rounded)
```

#### 字符串清理
```js
// 移除Markdown格式符号
cleanText
  .replace(/\*\*(.*?)\*\*/g, '$1')  // 粗体
  .replace(/\*(.*?)\*/g, '$1')      // 斜体
  .replace(/`(.*?)`/g, '$1')        // 行内代码
```

### 用户体验

1. **阅读体验**：
   - 排版清晰，层次分明
   - 字体统一，视觉舒适
   - 符合中文阅读习惯

2. **功能体验**：
   - 预览即所得，所见即发布效果
   - 复制功能完整保留格式
   - 操作简单直观

3. **兼容性**：
   - 适配移动端显示
   - 支持各种内容类型
   - 保持向后兼容

---

## 注意事项

1. **数据质量**: 输入的文章质量直接影响洞察质量
2. **模型选择**: 建议使用GPT-4或同等能力的模型
3. **成本控制**: 注意API调用成本，合理设置分析数量
4. **内容安全**: 确保生成内容符合平台规范
5. **定期维护**: 根据业务需求定期优化提示词
6. **预览优化**: 公众号预览样式需要定期根据用户反馈调整

---

## 更新日志

### v1.3.0 (2024-11-15)
- 新增公众号预览优化系统
- 添加Markdown符号清理功能
- 实现公众号风格排版样式
- 优化字体大小和颜色方案
- 完善图片显示和布局处理
- 添加首行缩进等中文排版特性

### v1.2.0 (2024-11-15)
- 新增智能图片提示词生成系统
- 添加基于文章内容的图片提示词AI生成
- 完善6种图片风格配置（智能选择、商务专业、创意插画、简约现代、科技未来、生活温馨）
- 新增图片生成重试机制和fallback处理
- 集成内容缓存和历史记录系统

### v1.1.0 (2024-11-15)
- 新增文章创作提示词
- 添加智能写作风格推荐系统
- 完善基于三维度分析的内容生成
- 新增文章创作系统角色提示词

### v1.0.0 (2024-11-15)
- 创建完整提示词文档
- 优化三维度分析框架
- 统一输出格式标准
- 添加详细注释说明

### 优化记录
- 2024-11-15: 新增公众号预览优化系统，实现Markdown到公众号样式的转换
- 2024-11-15: 优化预览排版，移除星号等符号显示
- 2024-11-15: 统一字体大小和颜色方案
- 2024-11-15: 添加首行缩进等中文排版特性
- 2024-11-15: 新增智能图片提示词生成系统，实现基于文章内容的图片生成
- 2024-11-15: 完善6种图片风格配置，支持用户自定义和智能选择
- 2024-11-15: 集成内容缓存系统，支持7天缓存和100条历史记录
- 2024-11-15: 添加图片生成重试机制，提高成功率
- 2024-11-15: 实现并行图片处理，提升生成效率
- 2024-11-15: 将决策阶段细化为6个阶段
- 2024-11-15: 优化人群场景分析要求
- 2024-11-15: 重构需求痛点分析维度
- 2024-11-15: 添加判断理由要求
- 2024-11-15: 新增智能写作风格推荐系统
- 2024-11-15: 完善文章创作提示词结构
- 2024-11-15: 添加基于三维度分析的内容生成逻辑

---

*最后更新: 2024年11月15日*